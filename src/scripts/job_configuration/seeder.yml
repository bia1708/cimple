# properties:
    #   - inject:
    #       keep-system-variables: true
    #       properties-file: "/var/lib/jenkins/workspace/properties_file.props"
    # dsl: |
    #     // script-text:
    #     //     !include-raw-verbatim: job.groovy
    #     pipeline {{
    #         agent any
    #         /* Define Pipeline Stages */
    #         stages {{
    #             stage('Set ENV') {{
    #                 steps {{
    #                     script {{
    #                         // Set environment variables
    #                         def props = readProperties  file:'/var/lib/jenkins/workspace/properties_file.props'
    #                         env.REPO= props['REPO']
    #                         env.REPO_NAME = props['REPO_NAME']
    #                         echo "${{env.REPO_NAME}}"
    #                     }}
    #                 }}
    #             }}
    #             stage('Checkout') {{
    #                 steps {{
    #                     checkout([
    #                         $class: 'GitSCM', branches: [[name: '*/main']],
    #                         extensions: [[$class: 'RelativeTargetDirectory', relativeTargetDir: "${{WORKSPACE}}"],],
    #                         userRemoteConfigs: [[credentialsId: "git_pat_${{REPO_NAME}}", url: "$REPO"]]
    #                     ])
    #                 }}
    #             }}
    #         }}
    #     }}

    #     // node {{
    #     //     stage("test") {{
    #     //         script {{
    #     //             sh 'pwd'
    #     //             def props = readProperties  file:'/var/lib/jenkins/workspace/properties_file.props'
    #     //             env.repo= props['REPO']
    #     //             sh 'echo ${{repo}}'
    #     //         }}
    #     //     }}
    #     // }}

- job:
    name: seeder
    project-type: pipeline
    sandbox: true
    parameters:
    - string:
        name: REPO
    - string:
        name: REPO_NAME
    dsl: |
        pipeline {{
            agent any

            stages {{
                stage('Generate Repo Job') {{
                    steps {{
                        jobDsl targets:"${{REPO_NAME}}/generate_job.groovy",
                            additionalParameters: [REPO : env.REPO, REPO_NAME : env.REPO_NAME]
                    }}
                }}
            }}
        }}
